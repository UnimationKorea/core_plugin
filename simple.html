<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ê°„ë‹¨í•œ ë ˆìŠ¨ í”Œë ˆì´ì–´</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #1e1e2e;
            color: #cdd6f4;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: #313244;
            padding: 1rem 2rem;
            border-bottom: 1px solid #45475a;
        }
        
        .header h1 {
            color: #cba6f7;
            font-size: 1.5rem;
        }
        
        .container {
            display: flex;
            flex: 1;
            min-height: 0;
        }
        
        .sidebar {
            width: 300px;
            background: #313244;
            padding: 1.5rem;
            border-right: 1px solid #45475a;
        }
        
        .main-content {
            flex: 1;
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }
        
        .activity-area {
            flex: 1;
            background: #313244;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1rem;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            padding: 1rem;
            background: #313244;
            border-radius: 12px;
        }
        
        .btn {
            background: #89b4fa;
            color: #1e1e2e;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn:hover {
            background: #74c7ec;
            transform: translateY(-1px);
        }
        
        .btn:disabled {
            background: #6c7086;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-danger {
            background: #f38ba8;
        }
        
        .btn-danger:hover {
            background: #eba0ac;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #a6adc8;
        }
        
        .form-select {
            width: 100%;
            padding: 0.75rem;
            background: #45475a;
            border: 1px solid #6c7086;
            border-radius: 6px;
            color: #cdd6f4;
            font-size: 0.9rem;
        }
        
        .card {
            background: #45475a;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #fab387;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        .notification.success { background: #a6e3a1; color: #1e1e2e; }
        .notification.error { background: #f38ba8; }
        .notification.info { background: #89b4fa; color: #1e1e2e; }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .video-container {
            width: 100%;
            max-width: 600px;
        }
        
        .video-container video {
            width: 100%;
            max-height: 400px;
            border-radius: 8px;
            background: black;
        }
        
        .quiz-container {
            text-align: center;
            max-width: 500px;
        }
        
        .question {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            color: #cba6f7;
        }
        
        .choices {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 1.5rem;
        }
        
        .choice {
            background: #89b4fa;
            color: #1e1e2e;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
        }
        
        .choice:hover {
            background: #74c7ec;
            transform: scale(1.05);
        }
        
        .drop-zone {
            background: #45475a;
            border: 2px dashed #6c7086;
            border-radius: 8px;
            padding: 2rem;
            margin: 1rem 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .drop-zone.drag-over {
            border-color: #89b4fa;
            background: rgba(137, 180, 250, 0.1);
        }
        
        .result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            font-weight: 600;
        }
        
        .result.correct {
            background: rgba(166, 227, 161, 0.2);
            color: #a6e3a1;
        }
        
        .result.incorrect {
            background: rgba(243, 139, 168, 0.2);
            color: #f38ba8;
        }
        
        /* Multiple Choice Template Styles */
        .multiple-choice-container {
            text-align: left;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .multiple-choice-question {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #45475a;
            border-radius: 8px;
            border-left: 4px solid #cba6f7;
        }
        
        .multiple-choice-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .choice-option {
            background: #45475a;
            border: 2px solid #6c7086;
            border-radius: 8px;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .choice-option:hover {
            border-color: #89b4fa;
            background: #585b70;
        }
        
        .choice-option.selected {
            border-color: #a6e3a1;
            background: rgba(166, 227, 161, 0.1);
        }
        
        .choice-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #6c7086;
            border-radius: 4px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .choice-option.selected .choice-checkbox {
            border-color: #a6e3a1;
            background: #a6e3a1;
        }
        
        .choice-option.selected .choice-checkbox::after {
            content: 'âœ“';
            color: #1e1e2e;
            font-weight: bold;
        }
        
        /* Word Guess Template Styles */
        .word-guess-container {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .word-display {
            font-family: 'Courier New', monospace;
            font-size: 2.5rem;
            letter-spacing: 0.5rem;
            margin: 2rem 0;
            color: #fab387;
            font-weight: bold;
        }
        
        .word-guess-input {
            background: #45475a;
            border: 2px solid #6c7086;
            border-radius: 8px;
            padding: 1rem;
            font-size: 1.2rem;
            color: #cdd6f4;
            text-align: center;
            margin: 1rem 0;
            width: 200px;
        }
        
        .word-guess-input:focus {
            outline: none;
            border-color: #89b4fa;
        }
        
        .guess-info {
            display: flex;
            justify-content: space-around;
            margin: 2rem 0;
            background: #45475a;
            padding: 1rem;
            border-radius: 8px;
        }
        
        .guess-stat {
            text-align: center;
        }
        
        .guess-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #89b4fa;
        }
        
        .wrong-letters {
            margin: 1rem 0;
            padding: 1rem;
            background: #45475a;
            border-radius: 8px;
            min-height: 40px;
        }
        
        .wrong-letter {
            display: inline-block;
            background: #f38ba8;
            color: #1e1e2e;
            padding: 0.25rem 0.5rem;
            margin: 0.25rem;
            border-radius: 4px;
            font-weight: bold;
        }
        
        /* Memory Game Template Styles */
        .memory-game-container {
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .memory-grid {
            display: grid;
            gap: 1rem;
            margin: 2rem 0;
            justify-content: center;
        }
        
        .memory-grid.grid-2x2 { grid-template-columns: repeat(2, 1fr); }
        .memory-grid.grid-4x2 { grid-template-columns: repeat(4, 1fr); }
        .memory-grid.grid-4x4 { grid-template-columns: repeat(4, 1fr); }
        
        .memory-card {
            width: 100px;
            height: 100px;
            background: #45475a;
            border: 2px solid #6c7086;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        .memory-card:hover {
            border-color: #89b4fa;
            transform: scale(1.05);
        }
        
        .memory-card.flipped {
            background: #89b4fa;
            color: #1e1e2e;
        }
        
        .memory-card.matched {
            background: #a6e3a1;
            color: #1e1e2e;
            border-color: #a6e3a1;
        }
        
        .memory-card-back {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #6c7086;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: transform 0.3s;
        }
        
        .memory-card.flipped .memory-card-back {
            transform: rotateY(180deg);
        }
        
        .memory-game-stats {
            display: flex;
            justify-content: space-around;
            margin: 1rem 0;
            background: #45475a;
            padding: 1rem;
            border-radius: 8px;
        }
        
        .memory-stat {
            text-align: center;
        }
        
        .memory-stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #fab387;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“ ê°„ë‹¨í•œ ë ˆìŠ¨ í”Œë ˆì´ì–´</h1>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <div class="card">
                <div class="card-title">ë ˆìŠ¨ ì„ íƒ</div>
                
                <div class="form-group">
                    <label class="form-label">ìƒ˜í”Œ ë ˆìŠ¨</label>
                    <select class="form-select" id="lesson-select">
                        <option value="">-- ë ˆìŠ¨ì„ ì„ íƒí•˜ì„¸ìš” --</option>
                        <option value="english">ê¸°ì´ˆ ì˜ì–´ íšŒí™”</option>
                        <option value="math">ìˆ˜í•™ ê¸°ì´ˆ ì—°ì‚°</option>
                        <option value="science">ê³¼í•™ ì‹¤í—˜</option>
                        <option value="realMultipleChoice">âœ¨ 4ì§€ ì„ ë‹¤í˜• í…ŒìŠ¤íŠ¸</option>
                        <option value="realWordGuess">âœ¨ ë‹¨ì–´ ë§ì¶”ê¸° í…ŒìŠ¤íŠ¸</option>
                        <option value="realMemoryGame">âœ¨ ë©”ëª¨ë¦¬ ê²Œì„ í…ŒìŠ¤íŠ¸</option>
                        <option value="jsonMultipleChoice">ğŸ“„ JSON: 4ì§€ ì„ ë‹¤í˜•</option>
                        <option value="jsonWordGuess">ğŸ“„ JSON: ë‹¨ì–´ ë§ì¶”ê¸°</option>
                        <option value="jsonMemoryGame">ğŸ“„ JSON: ë©”ëª¨ë¦¬ ê²Œì„</option>
                    </select>
                </div>
                
                <button class="btn" id="load-btn" disabled>ë ˆìŠ¨ ì‹œì‘</button>
            </div>
            
            <div class="card" id="lesson-info" style="display: none;">
                <div class="card-title">í˜„ì¬ ë ˆìŠ¨</div>
                <div id="lesson-title">-</div>
                <div style="font-size: 0.9rem; color: #a6adc8; margin-top: 0.5rem;">
                    <span id="activity-counter">0/0</span> í™œë™
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="activity-area" id="activity-area">
                <div>
                    <h2 style="color: #cba6f7; margin-bottom: 1rem;">ğŸ‘‹ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
                    <p>ì¢Œì¸¡ì—ì„œ ë ˆìŠ¨ì„ ì„ íƒí•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”.</p>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" id="prev-btn" disabled>â¬…ï¸ ì´ì „</button>
                <button class="btn" id="next-btn" disabled>ë‹¤ìŒ â¡ï¸</button>
                <button class="btn btn-danger" id="restart-btn" disabled>ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
            </div>
        </div>
    </div>
    
    <script>
        // ì „ì—­ ìƒíƒœ
        let currentLesson = null;
        let currentActivity = 0;
        let activities = [];
        let results = [];
        
        // ìƒ˜í”Œ ë ˆìŠ¨ ë°ì´í„°
        const sampleLessons = {
            english: {
                title: "ê¸°ì´ˆ ì˜ì–´ íšŒí™”",
                activities: [
                    {
                        type: "video",
                        title: "ì¸ì‚¬ë§ ë°°ìš°ê¸°",
                        content: {
                            src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
                            description: "ê¸°ë³¸ ì¸ì‚¬ë§ì„ ë°°ì›Œë³´ì„¸ìš”"
                        }
                    },
                    {
                        type: "quiz",
                        title: "ë‹¨ì–´ ë§ì¶”ê¸°", 
                        content: {
                            question: "ì•Œë§ì€ ì¸ì‚¬ë§ì„ ì„ íƒí•˜ì„¸ìš”: Good ____",
                            choices: ["morning", "night", "bye", "hello"],
                            correct: "morning"
                        }
                    }
                ]
            },
            math: {
                title: "ìˆ˜í•™ ê¸°ì´ˆ ì—°ì‚°",
                activities: [
                    {
                        type: "quiz",
                        title: "ë§ì…ˆ ë¬¸ì œ",
                        content: {
                            question: "2 + 3 = ?",
                            choices: ["4", "5", "6", "7"],
                            correct: "5"
                        }
                    }
                ]
            },
            science: {
                title: "ê³¼í•™ ì‹¤í—˜",
                activities: [
                    {
                        type: "video",
                        title: "ë¬¼ì˜ ìˆœí™˜",
                        content: {
                            src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
                            description: "ë¬¼ì˜ ìˆœí™˜ ê³¼ì •ì„ ì•Œì•„ë³´ì„¸ìš”"
                        }
                    }
                ]
            },
            // ì‹¤ì œ JSON íŒŒì¼ ë¡œë“œ í…ŒìŠ¤íŠ¸ìš©
            realMultipleChoice: {
                title: "4ì§€ ì„ ë‹¤í˜• ë¬¸ì œ ë°ëª¨",
                activities: [
                    {
                        type: "multiple-choice",
                        title: "í•œêµ­ì–´ ë¬¸ë²• ë¬¸ì œ",
                        content: {
                            question: "ë‹¤ìŒ ë¬¸ì¥ì—ì„œ ë¹ˆ ì¹¸ì— ë“¤ì–´ê°ˆ ì ì ˆí•œ ì¡°ì‚¬ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?\n\n'ì´ ì±…___ ë§¤ìš° ì¬ë¯¸ìˆìŠµë‹ˆë‹¤.'",
                            choices: [
                                { id: "choice-a", text: "ì€" },
                                { id: "choice-b", text: "ëŠ”" },
                                { id: "choice-c", text: "ì´" },
                                { id: "choice-d", text: "ê°€" }
                            ],
                            correctAnswer: "choice-a",
                            allowMultiple: false,
                            explanation: "'ì±…'ì€ ë°›ì¹¨ì´ ìˆìœ¼ë¯€ë¡œ 'ì€'ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. 'ì€/ëŠ”'ì€ ì£¼ì œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¡°ì‚¬ì…ë‹ˆë‹¤."
                        }
                    },
                    {
                        type: "multiple-choice",
                        title: "ìˆ˜í•™ ë¬¸ì œ - ì†Œìˆ˜",
                        content: {
                            question: "ë‹¤ìŒ ì¤‘ ì†Œìˆ˜(Prime Number)ì— í•´ë‹¹í•˜ëŠ” ê²ƒì„ ëª¨ë‘ ì„ íƒí•˜ì„¸ìš”.",
                            choices: [
                                { id: "choice-a", text: "2" },
                                { id: "choice-b", text: "3" },
                                { id: "choice-c", text: "4" },
                                { id: "choice-d", text: "5" }
                            ],
                            correctAnswer: ["choice-a", "choice-b", "choice-d"],
                            allowMultiple: true,
                            explanation: "ì†Œìˆ˜ëŠ” 1ê³¼ ìê¸° ìì‹ ìœ¼ë¡œë§Œ ë‚˜ëˆ„ì–´ì§€ëŠ” 1ë³´ë‹¤ í° ìì—°ìˆ˜ì…ë‹ˆë‹¤. 2, 3, 5ê°€ ì†Œìˆ˜ì…ë‹ˆë‹¤."
                        }
                    }
                ]
            },
            realWordGuess: {
                title: "ë‹¨ì–´ ë§ì¶”ê¸° ê²Œì„",
                activities: [
                    {
                        type: "word-guess",
                        title: "ë™ë¬¼ ë§ì¶”ê¸°",
                        content: {
                            word: "ì½”ë¼ë¦¬",
                            hint: "ì•„í”„ë¦¬ì¹´ì— ì‚¬ëŠ” í° ê·€ë¥¼ ê°€ì§„ íšŒìƒ‰ ë™ë¬¼",
                            category: "ë™ë¬¼",
                            maxAttempts: 6
                        }
                    },
                    {
                        type: "word-guess",
                        title: "ìŒì‹ ë§ì¶”ê¸°",
                        content: {
                            word: "íŒŒìŠ¤íƒ€",
                            hint: "ì´íƒˆë¦¬ì•„ì—ì„œ ì˜¨ ë©´ ìš”ë¦¬",
                            category: "ìŒì‹",
                            maxAttempts: 7
                        }
                    }
                ]
            },
            realMemoryGame: {
                title: "ë©”ëª¨ë¦¬ ê²Œì„ ë°ëª¨",
                activities: [
                    {
                        type: "memory-game",
                        title: "ê°€ì¡± ë‹¨ì–´ ê¸°ì–µí•˜ê¸°",
                        content: {
                            cards: [
                                { id: "card-1", content: "ì•„ë²„ì§€", matchId: "father" },
                                { id: "card-2", content: "Father", matchId: "father" },
                                { id: "card-3", content: "ì–´ë¨¸ë‹ˆ", matchId: "mother" },
                                { id: "card-4", content: "Mother", matchId: "mother" },
                                { id: "card-5", content: "í˜•/ëˆ„ë‚˜", matchId: "sibling" },
                                { id: "card-6", content: "Brother/Sister", matchId: "sibling" },
                                { id: "card-7", content: "í• ì•„ë²„ì§€", matchId: "grandfather" },
                                { id: "card-8", content: "Grandfather", matchId: "grandfather" }
                            ],
                            timeLimit: 120
                        }
                    }
                ]
            }
        };
        
        // DOM ìš”ì†Œë“¤
        const lessonSelect = document.getElementById('lesson-select');
        const loadBtn = document.getElementById('load-btn');
        const activityArea = document.getElementById('activity-area');
        const lessonInfo = document.getElementById('lesson-info');
        const lessonTitle = document.getElementById('lesson-title');
        const activityCounter = document.getElementById('activity-counter');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        lessonSelect.addEventListener('change', function() {
            loadBtn.disabled = !lessonSelect.value;
            console.log('ë ˆìŠ¨ ì„ íƒ:', lessonSelect.value);
        });
        
        loadBtn.addEventListener('click', function() {
            const selectedLesson = lessonSelect.value;
            if (selectedLesson) {
                loadLesson(selectedLesson);
            }
        });
        
        prevBtn.addEventListener('click', function() {
            if (currentActivity > 0) {
                currentActivity--;
                loadActivity(currentActivity);
                updateControls();
            }
        });
        
        nextBtn.addEventListener('click', function() {
            if (currentActivity < activities.length - 1) {
                currentActivity++;
                loadActivity(currentActivity);
                updateControls();
            } else {
                finishLesson();
            }
        });
        
        restartBtn.addEventListener('click', function() {
            if (confirm('ë ˆìŠ¨ì„ ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                currentActivity = 0;
                results = [];
                loadActivity(0);
                updateControls();
                showNotification('ë ˆìŠ¨ì„ ë‹¤ì‹œ ì‹œì‘í–ˆìŠµë‹ˆë‹¤.', 'info');
            }
        });
        
        // ë ˆìŠ¨ ë¡œë“œ í•¨ìˆ˜
        function loadLesson(lessonId) {
            console.log('ë ˆìŠ¨ ë¡œë“œ:', lessonId);
            
            // JSON íŒŒì¼ ë¡œë”© ì²´í¬
            if (lessonId.startsWith('json')) {
                const jsonFiles = {
                    'jsonMultipleChoice': 'sample-lesson-multiple-choice.json',
                    'jsonWordGuess': 'sample-lesson-word-guess.json',
                    'jsonMemoryGame': 'sample-lesson-memory-game.json'
                };
                
                const fileName = jsonFiles[lessonId];
                if (fileName) {
                    loadLessonFromJSON(fileName);
                    return;
                }
            }
            
            const lesson = sampleLessons[lessonId];
            if (!lesson) {
                showNotification('ë ˆìŠ¨ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            currentLesson = lesson;
            activities = lesson.activities;
            currentActivity = 0;
            results = [];
            
            // UI ì—…ë°ì´íŠ¸
            lessonTitle.textContent = lesson.title;
            lessonInfo.style.display = 'block';
            
            // ì²« ë²ˆì§¸ í™œë™ ë¡œë“œ
            loadActivity(0);
            updateControls();
            
            showNotification('ë ˆìŠ¨ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            console.log('ë ˆìŠ¨ ë¡œë“œ ì™„ë£Œ:', lesson);
        }
        
        // JSON íŒŒì¼ì—ì„œ ë ˆìŠ¨ ë¡œë“œ
        async function loadLessonFromJSON(fileName) {
            try {
                console.log('JSON íŒŒì¼ ë¡œë“œ:', fileName);
                showNotification('JSON íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ì¤‘...', 'info');
                
                const response = await fetch(fileName);
                if (!response.ok) {
                    throw new Error(`íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${fileName}`);
                }
                
                const lessonData = await response.json();
                console.log('JSON ë ˆìŠ¨ ë°ì´í„°:', lessonData);
                
                // JSON í˜•ì‹ì„ ë‚´ë¶€ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                const convertedLesson = convertJSONToInternalFormat(lessonData);
                
                currentLesson = convertedLesson;
                activities = convertedLesson.activities;
                currentActivity = 0;
                results = [];
                
                // UI ì—…ë°ì´íŠ¸
                lessonTitle.textContent = convertedLesson.title;
                lessonInfo.style.display = 'block';
                
                // ì²« ë²ˆì§¸ í™œë™ ë¡œë“œ
                loadActivity(0);
                updateControls();
                
                showNotification('JSON ë ˆìŠ¨ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                console.log('JSON ë ˆìŠ¨ ë¡œë“œ ì™„ë£Œ:', convertedLesson);
                
            } catch (error) {
                console.error('JSON ë¡œë“œ ì˜¤ë¥˜:', error);
                showNotification(`JSON ë¡œë“œ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }
        
        // JSON í˜•ì‹ì„ ë‚´ë¶€ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        function convertJSONToInternalFormat(lessonData) {
            console.log('JSON í˜•ì‹ ë³€í™˜ ì¤‘:', lessonData);
            
            const activities = lessonData.flow.map(flowItem => {
                const templateInfo = parseTemplate(flowItem.template);
                
                return {
                    type: templateInfo.name,
                    title: flowItem.activityId,
                    content: flowItem.params,
                    template: templateInfo
                };
            });
            
            return {
                title: lessonData.title,
                activities: activities
            };
        }
        
        // í…œí”Œë¦¿ ë¬¸ìì—´ íŒŒì‹± (ì˜ˆ: "multiple-choice@1.0.0")
        function parseTemplate(templateString) {
            const [name, version] = templateString.split('@');
            return {
                name: name,
                version: version || '1.0.0'
            };
        }
        
        // í™œë™ ë¡œë“œ í•¨ìˆ˜
        function loadActivity(index) {
            console.log('í™œë™ ë¡œë“œ:', index);
            
            if (!activities || index < 0 || index >= activities.length) {
                console.error('ìœ íš¨í•˜ì§€ ì•Šì€ í™œë™ ì¸ë±ìŠ¤:', index);
                return;
            }
            
            const activity = activities[index];
            console.log('í™œë™ ì •ë³´:', activity);
            
            // ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            activityCounter.textContent = `${index + 1}/${activities.length}`;
            
            // í™œë™ íƒ€ì…ì— ë”°ë¼ ë Œë”ë§
            if (activity.type === 'video') {
                renderVideoActivity(activity);
            } else if (activity.type === 'quiz') {
                renderQuizActivity(activity);
            } else if (activity.type === 'multiple-choice') {
                renderMultipleChoiceActivity(activity);
            } else if (activity.type === 'word-guess') {
                renderWordGuessActivity(activity);
            } else if (activity.type === 'memory-game') {
                renderMemoryGameActivity(activity);
            } else {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” í™œë™ íƒ€ì…:', activity.type);
                activityArea.innerHTML = '<div>ì§€ì›í•˜ì§€ ì•ŠëŠ” í™œë™ íƒ€ì…ì…ë‹ˆë‹¤: ' + activity.type + '</div>';
            }
        }
        
        // ë¹„ë””ì˜¤ í™œë™ ë Œë”ë§
        function renderVideoActivity(activity) {
            console.log('ë¹„ë””ì˜¤ í™œë™ ë Œë”ë§:', activity);
            
            activityArea.innerHTML = `
                <div class="video-container">
                    <h3 style="margin-bottom: 1rem; color: #fab387;">${activity.title}</h3>
                    <video controls>
                        <source src="${activity.content.src}" type="video/mp4">
                        ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.
                    </video>
                    <p style="margin-top: 1rem; color: #a6adc8;">${activity.content.description}</p>
                </div>
            `;
        }
        
        // í€´ì¦ˆ í™œë™ ë Œë”ë§
        function renderQuizActivity(activity) {
            console.log('í€´ì¦ˆ í™œë™ ë Œë”ë§:', activity);
            
            const choicesHtml = activity.content.choices.map(choice => 
                `<button class="choice" onclick="selectAnswer('${choice}')">${choice}</button>`
            ).join('');
            
            activityArea.innerHTML = `
                <div class="quiz-container">
                    <h3 style="margin-bottom: 1rem; color: #fab387;">${activity.title}</h3>
                    <div class="question">${activity.content.question}</div>
                    <div class="choices">${choicesHtml}</div>
                    <div class="drop-zone" id="drop-zone" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                        ì •ë‹µì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ ìœ„ì˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="result" id="result" style="display: none;"></div>
                </div>
            `;
            
            // ë“œë˜ê·¸ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸°
            const choices = document.querySelectorAll('.choice');
            choices.forEach(choice => {
                choice.draggable = true;
                choice.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', choice.textContent);
                });
            });
        }
        
        // Multiple Choice í™œë™ ë Œë”ë§
        function renderMultipleChoiceActivity(activity) {
            console.log('Multiple Choice í™œë™ ë Œë”ë§:', activity);
            
            const content = activity.content;
            const allowMultiple = content.allowMultiple || false;
            
            const optionsHtml = content.choices.map(choice => `
                <div class="choice-option" data-choice-id="${choice.id}" onclick="selectMultipleChoice('${choice.id}', ${allowMultiple})">
                    <div class="choice-checkbox"></div>
                    <span class="choice-text">${choice.text}</span>
                </div>
            `).join('');
            
            activityArea.innerHTML = `
                <div class="multiple-choice-container">
                    <h3 style="margin-bottom: 1rem; color: #fab387;">${activity.title}</h3>
                    <div class="multiple-choice-question">${content.question}</div>
                    <div class="multiple-choice-options">${optionsHtml}</div>
                    <div class="multiple-choice-controls">
                        <button class="btn" onclick="checkMultipleChoiceAnswer()" id="check-answer-btn" ${allowMultiple ? '' : 'style="display:none;"'}>
                            ë‹µì•ˆ í™•ì¸
                        </button>
                    </div>
                    <div class="result" id="result" style="display: none;"></div>
                    ${content.explanation ? `<div class="explanation" id="explanation" style="display: none; margin-top: 1rem; padding: 1rem; background: #45475a; border-radius: 8px;">${content.explanation}</div>` : ''}
                </div>
            `;
            
            // ì „ì—­ ë³€ìˆ˜ì— í˜„ì¬ í™œë™ ì •ë³´ ì €ì¥
            window.currentMultipleChoiceActivity = activity;
            window.selectedChoices = [];
        }
        
        // Word Guess í™œë™ ë Œë”ë§
        function renderWordGuessActivity(activity) {
            console.log('Word Guess í™œë™ ë Œë”ë§:', activity);
            
            const content = activity.content;
            const word = content.word.toUpperCase();
            const maxAttempts = content.maxAttempts || 6;
            
            // ë‹¨ì–´ í‘œì‹œ ì´ˆê¸°í™” (ë¹ˆ ì¹¸ìœ¼ë¡œ)
            const displayWord = word.split('').map(() => '_').join(' ');
            
            activityArea.innerHTML = `
                <div class="word-guess-container">
                    <h3 style="margin-bottom: 1rem; color: #fab387;">${activity.title}</h3>
                    <div class="word-display" id="word-display">${displayWord}</div>
                    <div class="guess-info">
                        <div class="guess-stat">
                            <div class="guess-stat-value" id="attempts-left">${maxAttempts}</div>
                            <div>ë‚¨ì€ ê¸°íšŒ</div>
                        </div>
                        <div class="guess-stat">
                            <div class="guess-stat-value" id="guessed-count">0</div>
                            <div>ë§ì¶˜ ê¸€ì</div>
                        </div>
                    </div>
                    <div style="margin: 1rem 0;">
                        <div style="margin-bottom: 1rem; color: #a6adc8;">
                            <strong>íŒíŠ¸:</strong> ${content.hint}
                        </div>
                        <div style="margin-bottom: 1rem; color: #a6adc8;">
                            <strong>ì¹´í…Œê³ ë¦¬:</strong> ${content.category}
                        </div>
                    </div>
                    <input type="text" class="word-guess-input" id="guess-input" placeholder="ê¸€ìë¥¼ ì…ë ¥í•˜ì„¸ìš”" maxlength="1" onkeyup="handleWordGuessInput(event)">
                    <div class="wrong-letters" id="wrong-letters">
                        <div style="color: #6c7086;">í‹€ë¦° ê¸€ìë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                    <div class="result" id="result" style="display: none;"></div>
                </div>
            `;
            
            // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
            window.currentWordGuessActivity = activity;
            window.wordGuessState = {
                word: word,
                guessedLetters: [],
                wrongLetters: [],
                attemptsLeft: maxAttempts,
                gameOver: false
            };
        }
        
        // Memory Game í™œë™ ë Œë”ë§
        function renderMemoryGameActivity(activity) {
            console.log('Memory Game í™œë™ ë Œë”ë§:', activity);
            
            const content = activity.content;
            const cards = [...content.cards]; // ì¹´ë“œ ë³µì‚¬
            
            // ì¹´ë“œ ì„ê¸°
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }
            
            const gridSize = Math.ceil(Math.sqrt(cards.length));
            const gridClass = `grid-${gridSize}x${Math.ceil(cards.length / gridSize)}`;
            
            const cardsHtml = cards.map(card => `
                <div class="memory-card" data-card-id="${card.id}" data-match-id="${card.matchId}" onclick="flipMemoryCard('${card.id}')">
                    <div class="memory-card-content">${card.content}</div>
                    <div class="memory-card-back">?</div>
                </div>
            `).join('');
            
            activityArea.innerHTML = `
                <div class="memory-game-container">
                    <h3 style="margin-bottom: 1rem; color: #fab387;">${activity.title}</h3>
                    <div class="memory-game-stats">
                        <div class="memory-stat">
                            <div class="memory-stat-value" id="matched-pairs">0</div>
                            <div>ë§¤ì¹­ëœ ìŒ</div>
                        </div>
                        <div class="memory-stat">
                            <div class="memory-stat-value" id="total-pairs">${cards.length / 2}</div>
                            <div>ì´ ìŒì˜ ìˆ˜</div>
                        </div>
                        <div class="memory-stat">
                            <div class="memory-stat-value" id="attempts">0</div>
                            <div>ì‹œë„ íšŸìˆ˜</div>
                        </div>
                        ${content.timeLimit ? `
                        <div class="memory-stat">
                            <div class="memory-stat-value" id="timer">${content.timeLimit}</div>
                            <div>ë‚¨ì€ ì‹œê°„(ì´ˆ)</div>
                        </div>
                        ` : ''}
                    </div>
                    <div class="memory-grid ${gridClass}" id="memory-grid">${cardsHtml}</div>
                    <div class="result" id="result" style="display: none;"></div>
                </div>
            `;
            
            // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
            window.currentMemoryGameActivity = activity;
            window.memoryGameState = {
                cards: cards,
                flippedCards: [],
                matchedPairs: 0,
                totalPairs: cards.length / 2,
                attempts: 0,
                gameOver: false,
                timeLeft: content.timeLimit || null
            };
            
            // íƒ€ì´ë¨¸ ì‹œì‘
            if (content.timeLimit) {
                startMemoryGameTimer();
            }
        }

        // ë‹µì•ˆ ì„ íƒ ì²˜ë¦¬
        function selectAnswer(answer) {
            console.log('ë‹µì•ˆ ì„ íƒ:', answer);
            checkAnswer(answer);
        }
        
        // ë“œë˜ê·¸ì•¤ë“œë¡­ ì²˜ë¦¬
        function handleDragOver(e) {
            e.preventDefault();
            document.getElementById('drop-zone').classList.add('drag-over');
        }
        
        function handleDragLeave(e) {
            document.getElementById('drop-zone').classList.remove('drag-over');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            const dropZone = document.getElementById('drop-zone');
            dropZone.classList.remove('drag-over');
            
            const answer = e.dataTransfer.getData('text/plain');
            console.log('ë“œë¡­ëœ ë‹µì•ˆ:', answer);
            checkAnswer(answer);
        }
        
        // ë‹µì•ˆ í™•ì¸
        function checkAnswer(selectedAnswer) {
            const activity = activities[currentActivity];
            const correctAnswer = activity.content.correct;
            const isCorrect = selectedAnswer === correctAnswer;
            
            console.log('ë‹µì•ˆ í™•ì¸:', selectedAnswer, 'ì •ë‹µ:', correctAnswer, 'ê²°ê³¼:', isCorrect);
            
            const dropZone = document.getElementById('drop-zone');
            const result = document.getElementById('result');
            
            dropZone.textContent = `ì„ íƒí•œ ë‹µ: ${selectedAnswer}`;
            
            if (isCorrect) {
                dropZone.style.background = 'rgba(166, 227, 161, 0.2)';
                dropZone.style.borderColor = '#a6e3a1';
                result.textContent = 'ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!';
                result.className = 'result correct';
                showNotification('ì •ë‹µì…ë‹ˆë‹¤!', 'success');
            } else {
                dropZone.style.background = 'rgba(243, 139, 168, 0.2)';
                dropZone.style.borderColor = '#f38ba8';
                result.textContent = 'âŒ í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.';
                result.className = 'result incorrect';
                showNotification('í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.', 'error');
            }
            
            result.style.display = 'block';
            
            // ê²°ê³¼ ì €ì¥
            results[currentActivity] = {
                selected: selectedAnswer,
                correct: correctAnswer,
                isCorrect: isCorrect
            };
        }
        
        // Multiple Choice ìƒí˜¸ì‘ìš© í•¨ìˆ˜ë“¤
        function selectMultipleChoice(choiceId, allowMultiple) {
            const selectedChoices = window.selectedChoices || [];
            const choiceElement = document.querySelector(`[data-choice-id="${choiceId}"]`);
            
            if (allowMultiple) {
                // ë‹¤ì¤‘ ì„ íƒ ëª¨ë“œ
                const index = selectedChoices.indexOf(choiceId);
                if (index === -1) {
                    selectedChoices.push(choiceId);
                    choiceElement.classList.add('selected');
                } else {
                    selectedChoices.splice(index, 1);
                    choiceElement.classList.remove('selected');
                }
                window.selectedChoices = selectedChoices;
            } else {
                // ë‹¨ì¼ ì„ íƒ ëª¨ë“œ - ì¦‰ì‹œ ë‹µì•ˆ í™•ì¸
                // ê¸°ì¡´ ì„ íƒ í•´ì œ
                document.querySelectorAll('.choice-option').forEach(el => el.classList.remove('selected'));
                // ìƒˆ ì„ íƒ í‘œì‹œ
                choiceElement.classList.add('selected');
                window.selectedChoices = [choiceId];
                
                // ì ì‹œ í›„ ë‹µì•ˆ í™•ì¸
                setTimeout(() => checkMultipleChoiceAnswer(), 500);
            }
        }
        
        function checkMultipleChoiceAnswer() {
            const activity = window.currentMultipleChoiceActivity;
            const selectedChoices = window.selectedChoices || [];
            const correctAnswer = activity.content.correctAnswer;
            
            let isCorrect = false;
            
            if (Array.isArray(correctAnswer)) {
                // ë‹¤ì¤‘ ì •ë‹µ ì²´í¬
                isCorrect = correctAnswer.length === selectedChoices.length && 
                           correctAnswer.every(answer => selectedChoices.includes(answer));
            } else {
                // ë‹¨ì¼ ì •ë‹µ ì²´í¬
                isCorrect = selectedChoices.length === 1 && selectedChoices[0] === correctAnswer;
            }
            
            const result = document.getElementById('result');
            const explanation = document.getElementById('explanation');
            
            if (isCorrect) {
                result.textContent = 'ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!';
                result.className = 'result correct';
                showNotification('ì •ë‹µì…ë‹ˆë‹¤!', 'success');
            } else {
                result.textContent = 'âŒ í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.';
                result.className = 'result incorrect';
                showNotification('í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.', 'error');
            }
            
            result.style.display = 'block';
            
            // ì„¤ëª… í‘œì‹œ
            if (explanation) {
                explanation.style.display = 'block';
            }
            
            // ê²°ê³¼ ì €ì¥
            results[currentActivity] = {
                selected: selectedChoices,
                correct: correctAnswer,
                isCorrect: isCorrect
            };
        }
        
        // Word Guess ìƒí˜¸ì‘ìš© í•¨ìˆ˜ë“¤
        function handleWordGuessInput(event) {
            if (event.key === 'Enter' || event.type === 'input') {
                const input = event.target;
                const letter = input.value.toUpperCase();
                
                if (letter && /[A-Zê°€-í£]/.test(letter)) {
                    guessLetter(letter);
                    input.value = '';
                }
            }
        }
        
        function guessLetter(letter) {
            const state = window.wordGuessState;
            
            if (state.gameOver || state.guessedLetters.includes(letter)) {
                return;
            }
            
            state.guessedLetters.push(letter);
            
            if (state.word.includes(letter)) {
                // ì •ë‹µ ê¸€ì
                updateWordDisplay();
                updateGuessedCount();
                
                // ë‹¨ì–´ ì™„ì„± ì²´í¬
                if (isWordComplete()) {
                    completeWordGuess(true);
                }
            } else {
                // í‹€ë¦° ê¸€ì
                state.wrongLetters.push(letter);
                state.attemptsLeft--;
                updateWrongLetters();
                updateAttemptsLeft();
                
                // ê²Œì„ ì˜¤ë²„ ì²´í¬
                if (state.attemptsLeft <= 0) {
                    completeWordGuess(false);
                }
            }
        }
        
        function updateWordDisplay() {
            const state = window.wordGuessState;
            const display = state.word.split('').map(letter => 
                state.guessedLetters.includes(letter) ? letter : '_'
            ).join(' ');
            
            document.getElementById('word-display').textContent = display;
        }
        
        function updateGuessedCount() {
            const state = window.wordGuessState;
            const correctLetters = [...new Set(state.word.split('').filter(letter => 
                state.guessedLetters.includes(letter)
            ))];
            document.getElementById('guessed-count').textContent = correctLetters.length;
        }
        
        function updateWrongLetters() {
            const state = window.wordGuessState;
            const wrongLettersElement = document.getElementById('wrong-letters');
            
            if (state.wrongLetters.length === 0) {
                wrongLettersElement.innerHTML = '<div style="color: #6c7086;">í‹€ë¦° ê¸€ìë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>';
            } else {
                wrongLettersElement.innerHTML = state.wrongLetters.map(letter => 
                    `<span class="wrong-letter">${letter}</span>`
                ).join('');
            }
        }
        
        function updateAttemptsLeft() {
            document.getElementById('attempts-left').textContent = window.wordGuessState.attemptsLeft;
        }
        
        function isWordComplete() {
            const state = window.wordGuessState;
            return state.word.split('').every(letter => state.guessedLetters.includes(letter));
        }
        
        function completeWordGuess(success) {
            const state = window.wordGuessState;
            state.gameOver = true;
            
            const result = document.getElementById('result');
            const input = document.getElementById('guess-input');
            
            input.disabled = true;
            
            if (success) {
                result.textContent = 'ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë‹¨ì–´ë¥¼ ë§ì¶”ì…¨ìŠµë‹ˆë‹¤!';
                result.className = 'result correct';
                showNotification('ë‹¨ì–´ë¥¼ ë§ì¶”ì…¨ìŠµë‹ˆë‹¤!', 'success');
            } else {
                result.textContent = `ğŸ˜” ê²Œì„ ì˜¤ë²„! ì •ë‹µì€ "${state.word}"ì˜€ìŠµë‹ˆë‹¤.`;
                result.className = 'result incorrect';
                showNotification('ê²Œì„ ì˜¤ë²„', 'error');
                
                // ì •ë‹µ í‘œì‹œ
                document.getElementById('word-display').textContent = state.word.split('').join(' ');
            }
            
            result.style.display = 'block';
            
            // ê²°ê³¼ ì €ì¥
            results[currentActivity] = {
                success: success,
                attemptsUsed: (window.currentWordGuessActivity.content.maxAttempts || 6) - state.attemptsLeft,
                word: state.word
            };
        }
        
        // Memory Game ìƒí˜¸ì‘ìš© í•¨ìˆ˜ë“¤
        function flipMemoryCard(cardId) {
            const state = window.memoryGameState;
            
            if (state.gameOver || state.flippedCards.length >= 2) {
                return;
            }
            
            const cardElement = document.querySelector(`[data-card-id="${cardId}"]`);
            
            if (cardElement.classList.contains('flipped') || cardElement.classList.contains('matched')) {
                return;
            }
            
            // ì¹´ë“œ ë’¤ì§‘ê¸°
            cardElement.classList.add('flipped');
            state.flippedCards.push(cardId);
            
            if (state.flippedCards.length === 2) {
                state.attempts++;
                updateMemoryGameStats();
                
                // ë§¤ì¹­ ì²´í¬
                setTimeout(() => checkMemoryMatch(), 1000);
            }
        }
        
        function checkMemoryMatch() {
            const state = window.memoryGameState;
            const [card1Id, card2Id] = state.flippedCards;
            
            const card1Element = document.querySelector(`[data-card-id="${card1Id}"]`);
            const card2Element = document.querySelector(`[data-card-id="${card2Id}"]`);
            
            const match1Id = card1Element.getAttribute('data-match-id');
            const match2Id = card2Element.getAttribute('data-match-id');
            
            if (match1Id === match2Id) {
                // ë§¤ì¹­ ì„±ê³µ
                card1Element.classList.add('matched');
                card2Element.classList.add('matched');
                state.matchedPairs++;
                
                updateMemoryGameStats();
                
                // ê²Œì„ ì™„ë£Œ ì²´í¬
                if (state.matchedPairs === state.totalPairs) {
                    completeMemoryGame(true);
                }
            } else {
                // ë§¤ì¹­ ì‹¤íŒ¨
                card1Element.classList.remove('flipped');
                card2Element.classList.remove('flipped');
            }
            
            state.flippedCards = [];
        }
        
        function updateMemoryGameStats() {
            const state = window.memoryGameState;
            document.getElementById('matched-pairs').textContent = state.matchedPairs;
            document.getElementById('attempts').textContent = state.attempts;
        }
        
        function startMemoryGameTimer() {
            const state = window.memoryGameState;
            
            const timer = setInterval(() => {
                if (state.gameOver || state.timeLeft <= 0) {
                    clearInterval(timer);
                    if (state.timeLeft <= 0 && !state.gameOver) {
                        completeMemoryGame(false);
                    }
                    return;
                }
                
                state.timeLeft--;
                document.getElementById('timer').textContent = state.timeLeft;
            }, 1000);
        }
        
        function completeMemoryGame(success) {
            const state = window.memoryGameState;
            state.gameOver = true;
            
            const result = document.getElementById('result');
            
            if (success) {
                result.textContent = 'ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ëª¨ë“  ì¹´ë“œë¥¼ ë§¤ì¹­í–ˆìŠµë‹ˆë‹¤!';
                result.className = 'result correct';
                showNotification('ë©”ëª¨ë¦¬ ê²Œì„ ì™„ë£Œ!', 'success');
            } else {
                result.textContent = 'â° ì‹œê°„ì´ ë¶€ì¡±í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”!';
                result.className = 'result incorrect';
                showNotification('ì‹œê°„ ì´ˆê³¼', 'error');
            }
            
            result.style.display = 'block';
            
            // ê²°ê³¼ ì €ì¥
            results[currentActivity] = {
                success: success,
                matchedPairs: state.matchedPairs,
                totalPairs: state.totalPairs,
                attempts: state.attempts,
                timeUsed: state.timeLeft ? (window.currentMemoryGameActivity.content.timeLimit - state.timeLeft) : null
            };
        }
        
        // ì»¨íŠ¸ë¡¤ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateControls() {
            prevBtn.disabled = currentActivity <= 0;
            nextBtn.disabled = !currentLesson;
            restartBtn.disabled = !currentLesson;
        }
        
        // ë ˆìŠ¨ ì™„ë£Œ
        function finishLesson() {
            const correctCount = results.filter(r => r && r.isCorrect).length;
            const totalCount = results.filter(r => r).length;
            const percentage = totalCount > 0 ? Math.round((correctCount / totalCount) * 100) : 0;
            
            setTimeout(() => {
                alert(`ğŸ‰ ë ˆìŠ¨ ì™„ë£Œ!
                
ğŸ“Š ê²°ê³¼:
ì •ë‹µë¥ : ${percentage}% (${correctCount}/${totalCount})

ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤! ğŸ‘`);
            }, 100);
        }
        
        // ì•Œë¦¼ í‘œì‹œ
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 3000);
        }
        
        // ì´ˆê¸°í™”
        console.log('ğŸš€ ê°„ë‹¨í•œ ë ˆìŠ¨ í”Œë ˆì´ì–´ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!');
        updateControls();
    </script>
</body>
</html>